<html>
  <head>
    <title>SMT</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="style.css"></link>
    <script src="//cdn.jsdelivr.net/npm/eruda"></script>
    <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.27.2.min.js"></script>

    <script>eruda.init();</script>
    <base target="_blank" />
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <select id="d">
      <option value="0">Water</option>
      <option value="2">Sand</option>
      <option value="1">Forest/Park</option>
      <option value="3">City</option>
    </select>
    <script>
      var c = document.getElementById("canvas").getContext("2d")
      var water = Array.from("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
      function getMousePosition(event) {
    // Get the position and size of the canvas relative to the viewport
    const rect = document.getElementById("canvas").getBoundingClientRect();

    // Calculate x and y coordinates relative to the canvas
    const x = event.clientX - rect.left;
    const y = event.clientY - rect.top;

    return { x, y };
}
      
      //view is at coords 0 0
      var view = [0,0]
      var gstat = {
  "bg":Array.from("000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
  "streets":[
    {
      "name": "Ding-Dong",
      "type": "street",
      "direction": 2, 
      "origin": [0,0],
      "ending": [10,0]
    }
  ],
  "stations":[
    {
      "name": "Ding-Dong Street",
      "pos": [5,0],
      "trains": ["c"]
    }
  ],
  "trains":[
    {
      "id": "c",
      "name": "c",
      "tcol": "white",
      "color": "blue",
      "stations": [0]
    }
  ]
}
      function update(){
        
        for(let ix = 0; ix<=15; ix++){
          for(let iy = 0; iy<=15; iy++){
            var x = view[0]*16+ix
            var y = view[1]*16+iy
            switch(gstat.bg[(x)*48+y]){
              case "0":
                c.fillStyle="blue"
                break
              case "1":
                c.fillStyle="lime"
                break
              case "2":
                c.fillStyle="yellow"
                break
              case "3":
                c.fillStyle="#404040"
                break
            }
            c.fillRect(ix*16, iy*16, 16, 16)
          }
        }
      }
      update()
      var placeType = '0'
    
    $('#d').on('change', function() {
        // This function will execute every time the selected option changes

        // Get the value of the newly selected option
        var selectedValue = $(this).val();

        // Perform your action here (e.g., display the value)
        placeType=Number(selectedValue)
    });
      canvas.addEventListener('click', function(event) {
    const pos = getMousePosition(canvas, event);
    gstat[(pos.x + view[0]*64)*48+pos.y+view[1]*64] = placeType
})
    </script>
  </body>
</html>
